services:
  - docker

jobs:
  include:
    - stage: Unit_test
      if: branch != master

      before_install:
        - docker pull ubuntu
        - docker build -t logickee/ubuntu-1804-zsh .
        - docker container prune -f
        - rm -rf /home/logic/_workspace/dotfiles/logs/*.log

      script:
        # - tests/run_test.sh
        # - travis_wait 50 cat tests/full_docker_commands.sh | while read i; do printf "%q\n" "$i"; done | xargs --max-procs=99 -I CMD bash -c CMD
        - docker run -t logickee/ubuntu-1804-zsh /installHelloworld.sh | tee logs/docker_installHelloworld.log
        - docker run -t logickee/ubuntu-1804-zsh /installCode.sh | tee logs/docker_installCode.log

      after_script:
        - docker container prune -f
